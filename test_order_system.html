<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 p-8">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h1>
    
    <div class="bg-white rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-bold mb-4">1. ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Login</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
          <select id="userSelect" class="w-full p-2 border rounded">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ --</option>
            <option value="admin">admin (Admin)</option>
            <option value="staff1">staff1 (Staff)</option>
            <option value="staff2">staff2 (Staff)</option>
          </select>
        </div>
        <button onclick="simulateLogin()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
          Login
        </button>
        <button onclick="simulateLogout()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
          Logout
        </button>
      </div>
      <div id="currentUserDisplay" class="mt-4 p-3 bg-gray-100 rounded"></div>
    </div>

    <div class="bg-white rounded-lg shadow p-6 mb-6">
      <h2 class="text-xl font-bold mb-4">2. ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π:</label>
          <select id="menuSelect" class="w-full p-2 border rounded">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π --</option>
            <option value="‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏´‡∏°‡∏π|45">‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏£‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏´‡∏°‡∏π - 45 ‡∏ö‡∏≤‡∏ó</option>
            <option value="‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á|50">‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á - 50 ‡∏ö‡∏≤‡∏ó</option>
            <option value="‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î|55">‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î - 55 ‡∏ö‡∏≤‡∏ó</option>
          </select>
        </div>
        <button onclick="addToOrder()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
          ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
        </button>
      </div>
      <div id="orderDisplay" class="mt-4"></div>
      <button onclick="submitTestOrder()" class="mt-4 w-full bg-indigo-500 text-white py-2 rounded hover:bg-indigo-600">
        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
      </button>
    </div>

    <div class="bg-white rounded-lg shadow p-6">
      <h2 class="text-xl font-bold mb-4">3. ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
      <button onclick="viewAllOrders()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 mb-4">
        ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
      </button>
      <div id="ordersDisplay"></div>
    </div>

    <div class="mt-6 bg-gray-800 text-white p-6 rounded-lg">
      <h2 class="text-xl font-bold mb-4">üìã Log</h2>
      <div id="logPanel" class="space-y-1 text-sm font-mono max-h-64 overflow-y-auto"></div>
    </div>
  </div>

  <script>
    let testOrder = [];
    let testCurrentUser = null;

    function log(message, type = 'info') {
      const logPanel = document.getElementById('logPanel');
      const time = new Date().toLocaleTimeString();
      const colors = {
        info: 'text-blue-400',
        success: 'text-green-400',
        warning: 'text-yellow-400',
        error: 'text-red-400'
      };
      const entry = document.createElement('div');
      entry.className = colors[type] || colors.info;
      entry.textContent = `[${time}] ${message}`;
      logPanel.appendChild(entry);
      logPanel.scrollTop = logPanel.scrollHeight;
    }

    function simulateLogin() {
      const username = document.getElementById('userSelect').value;
      if (!username) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ');
        return;
      }

      const users = {
        'admin': { username: 'admin', role: 'admin' },
        'staff1': { username: 'staff1', role: 'staff' },
        'staff2': { username: 'staff2', role: 'staff' }
      };

      testCurrentUser = users[username];
      sessionStorage.setItem('restaurant_current_user', JSON.stringify(testCurrentUser));
      
      document.getElementById('currentUserDisplay').innerHTML = `
        <p class="font-semibold">‚úÖ Login ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</p>
        <p>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ${testCurrentUser.username} (${testCurrentUser.role})</p>
      `;
      
      log(`Login: ${testCurrentUser.username}`, 'success');
    }

    function simulateLogout() {
      testCurrentUser = null;
      sessionStorage.removeItem('restaurant_current_user');
      document.getElementById('currentUserDisplay').innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ login</p>';
      log('Logout ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'info');
    }

    function addToOrder() {
      const menuValue = document.getElementById('menuSelect').value;
      if (!menuValue) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π');
        return;
      }

      const [name, price] = menuValue.split('|');
      const existing = testOrder.find(item => item.name === name);
      
      if (existing) {
        existing.qty++;
      } else {
        testOrder.push({
          id: Date.now(),
          name: name,
          price: parseFloat(price),
          qty: 1
        });
      }

      updateOrderDisplay();
      log(`‡πÄ‡∏û‡∏¥‡πà‡∏°: ${name}`, 'success');
    }

    function updateOrderDisplay() {
      const display = document.getElementById('orderDisplay');
      if (testOrder.length === 0) {
        display.innerHTML = '<p class="text-gray-500">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á</p>';
        return;
      }

      let total = 0;
      let html = '<div class="bg-gray-50 p-4 rounded"><h3 class="font-semibold mb-2">üßæ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤:</h3><ul class="space-y-1">';
      
      testOrder.forEach(item => {
        total += item.price * item.qty;
        html += `<li class="flex justify-between"><span>${item.name} x${item.qty}</span><span>${item.price * item.qty} ‡∏ö‡∏≤‡∏ó</span></li>`;
      });
      
      html += `</ul><p class="font-bold mt-2 pt-2 border-t">‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó</p></div>`;
      display.innerHTML = html;
    }

    function submitTestOrder() {
      if (testOrder.length === 0) {
        alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£');
        return;
      }

      if (!testCurrentUser) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ login ‡∏Å‡πà‡∏≠‡∏ô');
        return;
      }

      const total = testOrder.reduce((sum, item) => sum + (item.price * item.qty), 0);
      
      const orderData = {
        id: Date.now(),
        timestamp: new Date().toLocaleString(),
        username: testCurrentUser.username,
        orderedBy: testCurrentUser.username,
        items: testOrder,
        total: total.toString()
      };

      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
      const allOrders = JSON.parse(localStorage.getItem('allOrders') || '[]');
      allOrders.push(orderData);
      localStorage.setItem('allOrders', JSON.stringify(allOrders));

      log(`‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó`, 'success');
      alert(`‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\n‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á: ${testCurrentUser.username}\n‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${total} ‡∏ö‡∏≤‡∏ó`);

      // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
      testOrder = [];
      updateOrderDisplay();
      viewAllOrders();
    }

    function viewAllOrders() {
      const allOrders = JSON.parse(localStorage.getItem('allOrders') || '[]');
      const display = document.getElementById('ordersDisplay');

      if (allOrders.length === 0) {
        display.innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</p>';
        log('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå', 'warning');
        return;
      }

      let html = '<div class="space-y-4">';
      
      allOrders.forEach((order, index) => {
        let itemsHTML = '';
        if (order.items && Array.isArray(order.items)) {
          itemsHTML = order.items.map(item => 
            `<li>${item.name} x${item.qty} = ${item.price * item.qty} ‡∏ö‡∏≤‡∏ó</li>`
          ).join('');
        }

        html += `
          <div class="bg-gray-50 p-4 rounded border-l-4 border-indigo-500">
            <div class="flex justify-between items-start mb-2">
              <p class="font-semibold">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${index + 1}</p>
              <span class="text-sm text-gray-500">${order.timestamp}</span>
            </div>
            <p class="text-sm text-gray-600 mb-2">‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á: <strong>${order.username || order.orderedBy || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</strong></p>
            <ul class="ml-4 list-disc text-sm mb-2">${itemsHTML}</ul>
            <p class="font-bold text-green-600">‡∏£‡∏ß‡∏°: ${order.total} ‡∏ö‡∏≤‡∏ó</p>
          </div>
        `;
      });

      html += '</div>';
      display.innerHTML = html;
      log(`‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥: ${allOrders.length} ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå`, 'success');
    }

    // Initialize
    log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 'success');
    simulateLogout();
    updateOrderDisplay();
  </script>
</body>
</html>
